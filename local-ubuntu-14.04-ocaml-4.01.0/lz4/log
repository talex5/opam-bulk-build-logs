+ uname -m
# Detecting depexts using flags: x86_64 linux ubuntu
+ uname -s
+ lsb_release -i -s
+ opam list --safe --recursive --external=x86_64,linux,ubuntu --required-by=lz4
# The following system packages are needed:
#  - liblz4-dev
#  - m4
+ opam list --safe --recursive --external=source,x86_64,linux,ubuntu --required-by=lz4
# The following scripts need to be run:
#  - https://gist.githubusercontent.com/whitequark/eef074a8daa14602e447/raw/c151d3ab2f35f6cac54c7ef7459e2bbfff852938/install.sh
Not running as root, the following command will be run through "sudo":
    apt-get update
+ sudo apt-get update
Ign http://archive.ubuntu.com trusty InRelease
Ign http://archive.ubuntu.com trusty-updates InRelease
Ign http://archive.ubuntu.com trusty-security InRelease
Hit http://archive.ubuntu.com trusty Release.gpg
Get:1 http://archive.ubuntu.com trusty-updates Release.gpg [933 B]
Get:2 http://archive.ubuntu.com trusty-security Release.gpg [933 B]
Hit http://archive.ubuntu.com trusty Release
Get:3 http://archive.ubuntu.com trusty-updates Release [63.5 kB]
Get:4 http://archive.ubuntu.com trusty-security Release [63.5 kB]
Hit http://archive.ubuntu.com trusty/main Sources
Hit http://archive.ubuntu.com trusty/restricted Sources
Hit http://archive.ubuntu.com trusty/universe Sources
Hit http://archive.ubuntu.com trusty/main amd64 Packages
Hit http://archive.ubuntu.com trusty/restricted amd64 Packages
Hit http://archive.ubuntu.com trusty/universe amd64 Packages
Get:5 http://archive.ubuntu.com trusty-updates/main Sources [262 kB]
Get:6 http://archive.ubuntu.com trusty-updates/restricted Sources [3158 B]
Get:7 http://archive.ubuntu.com trusty-updates/universe Sources [149 kB]
Get:8 http://archive.ubuntu.com trusty-updates/main amd64 Packages [679 kB]
Get:9 http://archive.ubuntu.com trusty-updates/restricted amd64 Packages [18.1 kB]
Get:10 http://archive.ubuntu.com trusty-updates/universe amd64 Packages [373 kB]
Get:11 http://archive.ubuntu.com trusty-security/main Sources [106 kB]
Get:12 http://archive.ubuntu.com trusty-security/restricted Sources [1874 B]
Get:13 http://archive.ubuntu.com trusty-security/universe Sources [28.4 kB]
Get:14 http://archive.ubuntu.com trusty-security/main amd64 Packages [368 kB]
Get:15 http://archive.ubuntu.com trusty-security/restricted amd64 Packages [14.8 kB]
Get:16 http://archive.ubuntu.com trusty-security/universe amd64 Packages [138 kB]
Fetched 2270 kB in 26s (86.3 kB/s)
Reading package lists...
+ sudo apt-get install -qq -yy liblz4-dev m4
# OS package update successful
Not running as root, the following command will be run through "sudo":
    apt-get install -qq -yy liblz4-dev m4
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin: 
Selecting previously unselected package liblz4-1:amd64.
(Reading database ... 23161 files and directories currently installed.)
Preparing to unpack .../liblz4-1_0.0~r114-2ubuntu1_amd64.deb ...
Unpacking liblz4-1:amd64 (0.0~r114-2ubuntu1) ...
Selecting previously unselected package liblz4-dev:amd64.
Preparing to unpack .../liblz4-dev_0.0~r114-2ubuntu1_amd64.deb ...
Unpacking liblz4-dev:amd64 (0.0~r114-2ubuntu1) ...
Setting up liblz4-1:amd64 (0.0~r114-2ubuntu1) ...
Setting up liblz4-dev:amd64 (0.0~r114-2ubuntu1) ...
Processing triggers for libc-bin (2.19-0ubuntu6.6) ...
# OS packages installation successful
+ curl -L "https://gist.githubusercontent.com/whitequark/eef074a8daa14602e447/raw/c151d3ab2f35f6cac54c7ef7459e2bbfff852938/install.sh" | bash -ex -
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   144  100   144    0     0    766      0 --:--:-- --:--:-- --:--:--   770
+ V=r119
+ curl -OJL https://github.com/Cyan4973/lz4/archive/r119.tar.gz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100   118    0   118    0     0    310      0 --:--:-- --:--:-- --:--:--   311
  0     0    0   869    0     0   1075      0 --:--:-- --:--:-- --:--:--  1075  0     0    0  155k    0     0   145k      0 --:--:--  0:00:01 --:--:--  586k
curl: Saved to filename 'lz4-r119.tar.gz'
+ tar -zxvf lz4-r119.tar.gz
lz4-r119/
lz4-r119/.travis.yml
lz4-r119/LICENSE
lz4-r119/LZ4_Streaming_Format.odt
lz4-r119/Makefile
lz4-r119/NEWS
lz4-r119/README.md
lz4-r119/cmake_unofficial/
lz4-r119/cmake_unofficial/CMakeLists.txt
lz4-r119/lz4.c
lz4-r119/lz4.h
lz4-r119/lz4_format_description.txt
lz4-r119/lz4hc.c
lz4-r119/lz4hc.h
lz4-r119/programs/
lz4-r119/programs/COPYING
lz4-r119/programs/Makefile
lz4-r119/programs/bench.c
lz4-r119/programs/bench.h
lz4-r119/programs/datagen.c
lz4-r119/programs/fullbench.c
lz4-r119/programs/fuzzer.c
lz4-r119/programs/lz4.1
lz4-r119/programs/lz4c.1
lz4-r119/programs/lz4cat.1
lz4-r119/programs/lz4cli.c
lz4-r119/programs/lz4io.c
lz4-r119/programs/lz4io.h
lz4-r119/programs/xxhash.c
lz4-r119/programs/xxhash.h
+ cd lz4-r119
+ make
compiling static library
compiling dynamic library
creating versioned links
make[1]: Entering directory `/home/opam/opam-repository/lz4-r119/programs'
cc      -I.. -std=c99 -O3 -Wall -W -Wundef -DLZ4_VERSION=\"r119\" -DDISABLE_LZ4C_LEGACY_OPTIONS ../lz4.c ../lz4hc.c bench.c xxhash.c lz4io.c lz4cli.c -o lz4
cc      -I.. -std=c99 -O3 -Wall -W -Wundef -DLZ4_VERSION=\"r119\" ../lz4.c ../lz4hc.c bench.c xxhash.c lz4io.c lz4cli.c -o lz4c
make[1]: Leaving directory `/home/opam/opam-repository/lz4-r119/programs'
+ sudo make install
compiling static library
compiling dynamic library
creating versioned links
lz4 static and shared library installed
make[1]: Entering directory `/home/opam/opam-repository/lz4-r119/programs'
Installing binaries
Installing man pages
lz4 installation completed
make[1]: Leaving directory `/home/opam/opam-repository/lz4-r119/programs'
Source installation scripts run successfully
The following actions will be performed:
  - install ocamlfind  1.5.5                                    [required by lz4]
  - install base-bytes legacy                                   [required by lz4]
  - install ctypes     0.4.1                                    [required by lz4]
  - install lz4        1.0.1 
===== 4 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[ctypes: from default] Command started
[lz4: http] Command started
[ocamlfind: from default] Command started
[ocamlfind: from default] Command started
[ctypes: from default] Command started
[default] http://opam-archive:8080/archives/ocamlfind.1.5.5+opam.tar.gz downloaded
[default] http://opam-archive:8080/archives/ctypes.0.4.1+opam.tar.gz downloaded
[lz4: http] Command started
[ERROR] Bad checksum for /home/opam/.opam/packages.dev/lz4.1.0.1/v1.0.1.zip:
          - 2f4288d624a9cdaae394dcd2413c2b88 [expected result]
          - 0bb6c4780fda0cc2894f86931a4d6552 [actual result]
        This may be fixed by running `opam update`.

[ERROR] The sources of the following couldn't be obtained, aborting:
          - lz4.1.0.1
        (This may be fixed by running 'opam update')
'opam install lz4' failed.
